using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Drawing;
using System.Data;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;
using System.Net;
using System.Runtime.InteropServices;
using System.Text.RegularExpressions;
using System.IO;
using System.Drawing.Imaging;
using System.Web.Script.Serialization;

namespace NJBGoogleMapV2
{
    [ComVisible(true)]
    public partial class NJBGoogleMap : UserControl
    {
        //Event Handlers
        #region
        //MapLoadSuccess Event
        public event EventHandler MapLoadSuccess;
        protected virtual void OnMapLoadSuccess(EventArgs e)
        {
            if (MapLoadSuccess != null)
                MapLoadSuccess(this, e);
        }
        public void _MapLoadSuccess()
        {
            OnMapLoadSuccess(new EventArgs());
        }

        //MapLoadError Event
        public event EventHandler MapLoadError;
        protected virtual void OnMapLoadError(EventArgs e)
        {
            ShowLoading("<h2>Connection Error</h2>Please check your internet connection");
            if (MapLoadError != null)
                MapLoadError(this, e);
            Action LoadMap = () =>
            {
                System.Threading.Thread.Sleep(5000);
                ReloadMap();
            };
            System.Threading.Tasks.Task.Factory.StartNew(LoadMap);
        }
        public void _MapLoadError()
        {
            OnMapLoadError(new EventArgs());
        }

        //MapClick
        public event EventHandler<MapClickEventArgs> MapClick;
        protected virtual void OnMapClick(MapClickEventArgs e)
        {
            if (MapClick != null)
                MapClick(this, e);
        }
        public void _MapClick(object lat, object lng)
        {
            OnMapClick(new MapClickEventArgs(new MapLatLng(Convert.ToDouble(lat), Convert.ToDouble(lng))));
        }

        //MapRightClick
        public event EventHandler<MapClickEventArgs> MapRightClick;
        protected virtual void OnMapRightClick(MapClickEventArgs e)
        {
            if (MapRightClick != null)
                MapRightClick(this, e);
        }
        public void _MapRightClick(object lat, object lng)
        {
            OnMapRightClick(new MapClickEventArgs(new MapLatLng(Convert.ToDouble(lat), Convert.ToDouble(lng))));
        }

        //MapMarkerClick
        public event EventHandler<MapItemClickEventArgs> MapMarkerClick;
        protected virtual void OnMapMarkerClick(MapItemClickEventArgs e)
        {
            if (MapMarkerClick != null)
                MapMarkerClick(this, e);
        }
        public void _MapMarkerClick(object id)
        {
            OnMapMarkerClick(new MapItemClickEventArgs(id.ToString()));
        }

        //MapMarkerRightClick
        public event EventHandler<MapItemClickEventArgs> MapMarkerRightClick;
        protected virtual void OnMapMarkerRightClick(MapItemClickEventArgs e)
        {
            if (MapMarkerRightClick != null)
                MapMarkerRightClick(this, e);
        }
        public void _MapMarkerRightClick(object id)
        {
            OnMapMarkerRightClick(new MapItemClickEventArgs(id.ToString()));
        }

        //MapHouseClick
        public event EventHandler<MapItemClickEventArgs> MapHouseClick;
        protected virtual void OnMapHouseClick(MapItemClickEventArgs e)
        {
            if (MapHouseClick != null)
                MapHouseClick(this, e);
        }
        public void _MapHouseClick(object id)
        {
            OnMapHouseClick(new MapItemClickEventArgs(id.ToString()));
        }

        //MapHouseRightClick
        public event EventHandler<MapItemClickEventArgs> MapHouseRightClick;
        protected virtual void OnMapHouseRightClick(MapItemClickEventArgs e)
        {
            if (MapHouseRightClick != null)
                MapHouseRightClick(this, e);
        }
        public void _MapHouseRightClick(object id)
        {
            OnMapHouseRightClick(new MapItemClickEventArgs(id.ToString()));
        }

        //MapPolygonClick
        public event EventHandler<MapItemClickEventArgs> MapPolygonClick;
        protected virtual void OnMapPolygonClick(MapItemClickEventArgs e)
        {
            if (MapPolygonClick != null)
                MapPolygonClick(this, e);
        }
        public void _MapPolygonClick(object id)
        {
            OnMapPolygonClick(new MapItemClickEventArgs(id.ToString()));
        }

        //MapPolygonRightClick
        public event EventHandler<MapItemClickEventArgs> MapPolygonRightClick;
        protected virtual void OnMapPolygonRightClick(MapItemClickEventArgs e)
        {
            if (MapPolygonRightClick != null)
                MapPolygonRightClick(this, e);
        }
        public void _MapPolygonRightClick(object id)
        {
            OnMapPolygonRightClick(new MapItemClickEventArgs(id.ToString()));
        }

        //MapDrawingComplete
        public event EventHandler<MapDrawingCompleteEventArgs> MapDrawingComplete;
        protected virtual void OnMapDrawingComplete(MapDrawingCompleteEventArgs e)
        {
            if (MapDrawingComplete != null)
                MapDrawingComplete(this, e);
        }
        public void _MapDrawingComplete(object path)
        {
            List<MapLatLng> LatLng = new List<MapLatLng>();

            string json = path.ToString();
            json = json.Replace("[","");
            json = json.Replace("]", "");
            json = json.Replace("\"", "");
            json = json.Replace("},", "}*");
            foreach (string str in json.Split('*'))
            {
                string val = str;
                val = val.Replace("{lat:", "");
                val = val.Replace("lng:", "");
                val = val.Replace("}", "");
                LatLng.Add(new MapLatLng(Convert.ToDouble(val.Split(',')[0]), Convert.ToDouble(val.Split(',')[1])));
            }
            OnMapDrawingComplete(new MapDrawingCompleteEventArgs(LatLng.ToArray()));   
        }        
        #endregion
        //Images
        #region
        private static string LoadingBackground = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAA4CAIAAACEzMqPAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA3ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDIxIDc5LjE1NTc3MiwgMjAxNC8wMS8xMy0xOTo0NDowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpjY2IwZTg2MS0xMzJjLTU5NDAtOGYyMi01OTMyNGY3NGM5ODAiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QUI4QTdEQ0M1N0I4MTFFNkE5NkM4RkNDOUNGNUREMTciIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QUI4QTdEQ0I1N0I4MTFFNkE5NkM4RkNDOUNGNUREMTciIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTQgKFdpbmRvd3MpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6Y2NiMGU4NjEtMTMyYy01OTQwLThmMjItNTkzMjRmNzRjOTgwIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOmNjYjBlODYxLTEzMmMtNTk0MC04ZjIyLTU5MzI0Zjc0Yzk4MCIv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";
        private static string LoadingGIF = "data:image/gif;base64,R0lGODlh5gAeAIABAP///////yH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDIxIDc5LjE1NTc3MiwgMjAxNC8wMS8xMy0xOTo0NDowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTQgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjlGNjAzQjJCNTdCMjExRTZCMEY2OEEzMjc0MUYzRjIyIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjlGNjAzQjJDNTdCMjExRTZCMEY2OEEzMjc0MUYzRjIyIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OUY2MDNCMjk1N0IyMTFFNkIwRjY4QTMyNzQxRjNGMjIiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OUY2MDNCMkE1N0IyMTFFNkIwRjY4QTMyNzQxRjNGMjIiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4B//79/Pv6+fj39vX08/Lx8O/u7ezr6uno5+bl5OPi4eDf3t3c29rZ2NfW1dTT0tHQz87NzMvKycjHxsXEw8LB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";
        private static string LoadingGoogleMapLogo = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAVAAAAA3CAYAAABabhKPAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDIxIDc5LjE1NTc3MiwgMjAxNC8wMS8xMy0xOTo0NDowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTQgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkNFMkZBRTc2NTdBRjExRTY4ODhERTlGQ0Y0MTAwMUVFIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkNFMkZBRTc3NTdBRjExRTY4ODhERTlGQ0Y0MTAwMUVFIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6Q0UyRkFFNzQ1N0FGMTFFNjg4OERFOUZDRjQxMDAxRUUiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6Q0UyRkFFNzU1N0FGMTFFNjg4OERFOUZDRjQxMDAxRUUiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7TXdE3AAA+LUlEQVR42ux9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";
        #endregion
        //Style or CSS
        #region
        private static string Style = "" +
            "<style>" +
                "html, body {height: 100%; width: 100%; padding: 0; margin: 0; overflow: hidden; } " +
                "#map {height: 100%; }" +
                ".controls {margin-top: 10px; border: 1px solid transparent; border-radius: 2px 0 0 2px; box-sizing: border-box; -moz-box-sizing: border-box; height: 32px; outline: none; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3); }" +
                "#pac-input {z-index: 1060; background-color: #fff; font-family: Roboto; font-size: 15px; font-weight: 300; margin-left: 12px; padding: 0 11px 0 13px; text-overflow: ellipsis; width: 300px; }" +
                "#pac-input:focus {border-color: #4d90fe; }" +
                ".pac-container {font-family: Roboto; z-index: 1060; }" +
                "#type-selector {color: #fff; background-color: #4d90fe; padding: 5px 11px 0px 11px; }" +
                "#type-selector label {font-family: Roboto; font-size: 13px; font-weight: 300; }" +
                "#target {width: 345px; }" +
                "#LoadingPage {display: block; color: white; font-family: Arial; background-image: url(" + LoadingBackground + "); background-repeat: no-repeat; background-size: cover; background-position: 50% 50%; position: fixed; z-index: 100; }" +
                ".FullWidHei {width: 100%; height: 100%; }" +
                ".ZeroMarPad {margin: 0; padding: 0; }" +
                ".center1 {display: table; text-align: center; vertical-align: middle; }" +
                ".center2 {display: table-cell; text-align: center; vertical-align: middle; }" +
            "</style>";
        #endregion
        //HTML Body
        #region
        private static string Body = "" +
            "<div id=\"LoadingPage\" class=\"ZeroMarPad FullWidHei\">" +
                "<div class=\"center1 ZeroMarPad FullWidHei\">" +
                    "<div class=\"center2 ZeroMarPad FullWidHei\">" +
                        "<h4 id=\"LoadingTitle\" class=\"ZeroMarPad\">Loading Map</h4>" +
                        "<div style=\"width: 100%; height: 10px;\"></div>" +
                        "<img src=\"" + LoadingGIF + "\" width=\"130px\" />" +
                        "<div style=\"width: 100%; height: 0px;\"></div>" +
                        "<img src=\"" + LoadingGoogleMapLogo + "\" width=\"180px\" />" +
                        "<p style=\"color: rgba(50, 50, 50, 1);\" class=\"ZeroMarPad\"><small>&copy; DLL File By NJB</small></p>" +
                    "</div>" +
                "</div>" +
            "</div>" +
            "<canvas id=\"canvas\" style=\"display: none;\"></canvas>" +
            "<div id=\"map\" style=\"width: 100%; height: 100vh;\"></div>";
        #endregion
        //Javascript
        #region

        private static string Script = "" +
            "<script>" +
                "var LoadPage = {" +
                    "DOM: document.getElementById('LoadingPage')," +
                    "Title: document.getElementById('LoadingTitle')," +
                    "ChangeTitle: function (text) {this.Title.innerHTML = text;}," +
                    "Hide: function () {this.DOM.style.display = 'none';}," +
                    "Show: function () {this.DOM.style.display = 'block';}" +
                "};" +
                "var GoogleMap = {" +
                    "Map: null," +
                    "Markers: {}," +
                    "Houses: {}," +
                    "Polygons: {}," +
                    "SelectedHouses: {}," +
                    "SelectMode: false," +
                    "DrawingMode: false," +
                    "DrawingManager: null" +
                "};" +
                "var SelectProps = {" +
                    "SelectedColor: {primary: 'red', secondary: 'white'}," +
                    "UnSelectedColor: {primary: 'gray', secondary: 'white'}" +
                "};" +
                "function MapLoadSuccess() { setTimeout(function() { window.external._MapLoadSuccess(); }) }" +
                "function MapLoadError() { window.external._MapLoadError(); }" +
                "function ConvertLatLngToObject(latLng) {return {lat: latLng.lat(), lng: latLng.lng()} }" +
                "function GetPathFromArray(Paths) {var result = []; Paths.forEach(function (path) {result.push(ConvertLatLngToObject(path)); }); return result; }" +
                "function ConvertObjectToArray(obj) {return Object.keys(obj).map(function(k) { return obj[k] }); }" +
                "function GetListID(obj) {return Object.keys(obj).map(function(k) { return obj[k].id }); }" +
                "function MakeHousePin(label, pincolor, itemcolor) {var c = document.createElement(\"canvas\"); c.width = 40; c.height = 50; var ctx = c.getContext(\"2d\"); var grd = ctx.createLinearGradient(30, 0, 0, 70); grd.addColorStop(0, pincolor); grd.addColorStop(1, \"white\"); ctx.beginPath(); ctx.arc(20, 20, 20, 0, 2 * Math.PI); ctx.moveTo(35, 33); ctx.lineTo(20, 50); ctx.lineTo(5, 33); ctx.fillStyle = \"#e6e6e6\"; ctx.fill(); ctx.strokeStyle = \"#666666\"; ctx.stroke(); ctx.beginPath(); ctx.arc(20, 20, 17, 0, 2 * Math.PI); ctx.fillStyle = grd; ctx.fill(); ctx.stroke(); if (label.trim() == \"\" || label == null) {ctx.beginPath(); ctx.moveTo(20, 6); ctx.lineTo(34, 16); ctx.lineTo(34, 20); ctx.lineTo(20, 10); ctx.lineTo(6, 20); ctx.lineTo(6, 16); ctx.fillStyle = itemcolor; ctx.fill(); ctx.beginPath(); ctx.moveTo(10, 20); ctx.lineTo(20, 13); ctx.lineTo(30, 20); ctx.lineTo(30, 30); ctx.lineTo(22.5, 30); ctx.lineTo(22.5, 23); ctx.lineTo(17.5, 23); ctx.lineTo(17.5, 30); ctx.lineTo(10, 30); ctx.fillStyle = itemcolor; ctx.fill(); } else {ctx.font = \"18px Arial\"; ctx.fillStyle = itemcolor; ctx.textAlign = \"center\"; ctx.fillText(label, 20, 27); } return c.toDataURL(); }" +
                "function MapIsReady() {return (google && google.maps); }" +
                "function GetMapCenter(){if(GoogleMap.Map != null) return {lat: GoogleMap.Map.getCenter().lat(), lng: GoogleMap.Map.getCenter().lng()}; return {lat: null, lng: null}; }" +
                "function SetMapCenter(position) {if(GoogleMap.Map != null) GoogleMap.Map.setCenter(position); }" +
                "function GetMapType(){if(GoogleMap.Map != null) return GoogleMap.Map.getMapTypeId(); return null; }" +
                "function SetMapType(type) {if(GoogleMap.Map != null) GoogleMap.Map.setMapTypeId(type); }" +
                "function GetMapZoom() {if(GoogleMap.Map != null) return GoogleMap.Map.getZoom(); return null; }" +
                "function SetMapZoom(value) {if(GoogleMap.Map != null) GoogleMap.Map.setZoom(value); }" +
                "function MarkerExists(id) {if(GoogleMap.Map != null) return (!(GoogleMap.Markers['M' + id] == null || GoogleMap.Markers['M' + id] == undefined)); return false; }" +
                "function MarkerVisible(id) {if(GoogleMap.Map != null) if(MarkerExists(id)) return (!(GoogleMap.Markers['M' + id].map == null)); return false; }" +
                "function HideMarker(id) {if(GoogleMap.Map != null) if(MarkerExists(id)) GoogleMap.Markers['M' + id].setMap(null); }" +
                "function ShowMarker(id) {if(GoogleMap.Map != null) if(MarkerExists(id)) GoogleMap.Markers['M' + id].setMap(GoogleMap.Map); }" +
                "function GetMarkerPosition(id) {if(GoogleMap.Map != null) if(MarkerExists(id)) return {lat: GoogleMap.Markers['M' + id].getPosition().lat(), lng: GoogleMap.Markers['M' + id].getPosition().lng()}; return {lat: null, lng: null}; }" +
                "function SetMarkerPosition(id, position) {if(GoogleMap.Map != null) if(MarkerExists(id)) GoogleMap.Markers['M' + id].setPosition(position); }" +
                "function GetMarkerTitle(id) {if(GoogleMap.Map != null) if(MarkerExists(id)) return GoogleMap.Markers['M' + id].getTitle(); return null; }" +
                "function SetMarkerTitle(id, title) {if(GoogleMap.Map != null) if(MarkerExists(id)) GoogleMap.Markers['M' + id].setTitle(title); }" +
                "function DeleteMarker(id) {if(GoogleMap.Map != null) if(MarkerExists(id)){HideMarker(id); delete GoogleMap.Markers['M' + id]; } }" +
                "function DeleteAllMarkers() {GetListID(GoogleMap.Markers).forEach(function (id) {DeleteMarker(id); }); }" +
                "function GetMarkerDraggable(id) {if(GoogleMap.Map != null) if(MarkerExists(id)) return GoogleMap.Markers['M' + id].getDraggable(); return false; }" +
                "function GetMarkerIcon(id) {if(GoogleMap.Map != null) if(MarkerExists(id)) return GoogleMap.Markers['M' + id]._icon || null; return null; }" +
                "function SetMarkerIcon(id, icon, value) {if(GoogleMap.Map != null) if(MarkerExists(id)) { GoogleMap.Markers['M' + id].setIcon(value); GoogleMap.Markers['M' + id]._icon = icon; } }" +
                "function SetMarkerDraggable(id, draggable) {if(GoogleMap.Map != null) if(MarkerExists(id)) {var animation = null; if (draggable) animation = google.maps.Animation.BOUNCE; GoogleMap.Markers['M' + id].setDraggable(draggable); GoogleMap.Markers['M' + id].setAnimation(animation); } }" +
                "function CreateMarker(id, title, position, draggable) {if(GoogleMap.Map != null){if(MarkerExists(id)) GoogleMap.Markers['M' + id].setMap(null); var animation = null; if(draggable) animation = google.maps.Animation.BOUNCE; GoogleMap.Markers['M' + id] = new google.maps.Marker({position: {lat: parseFloat(position.lat), lng: parseFloat(position.lng) }, draggable: draggable, map: GoogleMap.Map, title: title, id: id, animation: animation }); GoogleMap.Markers['M' + id].addListener('click', function() { window.external._MapMarkerClick(this.id); }); GoogleMap.Markers['M' + id].addListener('rightclick', function() { window.external._MapMarkerRightClick(this.id); }); } }" +
                "function FitHousesToMap() {if(GoogleMap.Map != null){var MyBounds = new google.maps.LatLngBounds(); var Houses = ConvertObjectToArray(GoogleMap.Houses); if(Houses.length > 0){Houses.forEach(function (house) {MyBounds.extend(house.getPosition()); }); GoogleMap.Map.fitBounds(MyBounds); } } }" +
                "function HouseExists(id) {if(GoogleMap.Map != null) return (!(GoogleMap.Houses['M' + id] == null || GoogleMap.Houses['M' + id] == undefined)); return false; }" +
                "function HouseVisible(id) {if(GoogleMap.Map != null) if(HouseExists(id)) return (!(GoogleMap.Houses['M' + id].map == null)); return false; }" +
                "function HideHouse(id) {if(GoogleMap.Map != null) if(HouseExists(id)) GoogleMap.Houses['M' + id].setMap(null); }" +
                "function ShowHouse(id) {if(GoogleMap.Map != null) if(HouseExists(id)) GoogleMap.Houses['M' + id].setMap(GoogleMap.Map); }" +
                "function GetHousePosition(id) {if(GoogleMap.Map != null) if(HouseExists(id)) return {lat: GoogleMap.Houses['M' + id].getPosition().lat(), lng: GoogleMap.Houses['M' + id].getPosition().lng()}; return {lat: null, lng: null}; }" +
                "function SetHousePosition(id, position) {if(GoogleMap.Map != null) if(HouseExists(id)) GoogleMap.Houses['M' + id].setPosition(position); }" +
                "function GetHouseTitle(id) {if(GoogleMap.Map != null) if(HouseExists(id)) return GoogleMap.Houses['M' + id].getTitle(); return null; }" +
                "function SetHouseTitle(id, title) {if(GoogleMap.Map != null) if(HouseExists(id)) GoogleMap.Houses['M' + id].setTitle(title); }" +
                "function GetHouseLabel(id) {if(GoogleMap.Map != null) if(HouseExists(id)) return GoogleMap.Houses['M' + id].hlabel; return null; }" +
                "function SetHouseLabel(id, label) {if(GoogleMap.Map != null) if(HouseExists(id)){GoogleMap.Houses['M' + id].hlabel = label; GoogleMap.Houses['M' + id].setIcon(MakeHousePin(label, GoogleMap.Houses['M' + id].color.primary, GoogleMap.Houses['M' + id].color.secondary)); } }" +
                "function GetHouseColor(id) {if(GoogleMap.Map != null) if(HouseExists(id)) return GoogleMap.Houses['M' + id].color; return null; }" +
                "function SetHouseColor(id, color) {if(GoogleMap.Map != null) if(HouseExists(id)){GoogleMap.Houses['M' + id].color = color; GoogleMap.Houses['M' + id].setIcon(MakeHousePin(GoogleMap.Houses['M' + id].hlabel, color.primary, color.secondary)); } return null; }" +
                "function DeleteHouse(id) {if(GoogleMap.Map != null) if(HouseExists(id)){HideHouse(id); delete GoogleMap.Houses['M' + id]; } }" +
                "function DeleteAllHouses() {GetListID(GoogleMap.Houses).forEach(function (id) {DeleteHouse(id); }); }" +
                "function GetHouseDraggable(id) {if(GoogleMap.Map != null) if(HouseExists(id)) return GoogleMap.Houses['M' + id].getDraggable(); return false; }" +
                "function SetHouseDraggable(id, draggable) {if(GoogleMap.Map != null) if(HouseExists(id)) {var animation = null; if (draggable) animation = google.maps.Animation.BOUNCE; GoogleMap.Houses['M' + id].setDraggable(draggable); GoogleMap.Houses['M' + id].setAnimation(animation); } }" +
                "function SelectHouse(id) {if(GoogleMap.SelectMode){GoogleMap.SelectedHouses['M' + id] = GoogleMap.Houses['M' + id]; SetHouseColor(id, SelectProps.SelectedColor); } }" +
                "function DeselectHouse(id) {if(GoogleMap.SelectMode){delete GoogleMap.SelectedHouses['M' + id]; SetHouseColor(id, SelectProps.UnSelectedColor); } }" +
                "function HouseSelected(id) {if(GoogleMap.SelectMode){if(GoogleMap.Houses['M' + id].color == SelectProps.SelectedColor) return true } return false; }" +
                "function SelectMode(arg) {if(GoogleMap.Map != null) {GoogleMap.SelectMode = arg; if(GoogleMap.SelectMode){if(GetListID(GoogleMap.Houses).length > 0){GetListID(GoogleMap.Houses).forEach(function (id) {GoogleMap.Houses['M' + id].orig_color = GoogleMap.Houses['M' + id].color; SetHouseColor(id, SelectProps.UnSelectedColor); }); } else{alert('Map is empty. Nothing to select.'); } } else{GetListID(GoogleMap.Houses).forEach(function (id) {GoogleMap.SelectedHouses = {}; SetHouseColor(id, GoogleMap.Houses['M' + id].orig_color); }); } } }" +
                "function CreateHouse(id, title, position, label, color, draggable) {if(GoogleMap.Map != null){if(HouseExists(id)) GoogleMap.Houses['M' + id].setMap(null); var animation = null; if(draggable) animation = google.maps.Animation.BOUNCE; GoogleMap.Houses['M' + id] = new google.maps.Marker({position: {lat: parseFloat(position.lat), lng: parseFloat(position.lng) }, map: GoogleMap.Map, icon: MakeHousePin(label, color.primary, color.secondary), title: title, id: id, hlabel: label, color: color, draggable: draggable, animation: animation }); GoogleMap.Houses['M' + id].addListener('click', function() {if(GoogleMap.SelectMode){if(!HouseSelected(this.id)) SelectHouse(this.id); else DeselectHouse(this.id); } window.external._MapHouseClick(this.id); }); GoogleMap.Houses['M' + id].addListener('rightclick', function() { window.external._MapHouseRightClick(this.id); }); } }" +
                "function DrawingMode(arg) {GoogleMap.DrawingMode = arg; if(GoogleMap.DrawingMode){GoogleMap.DrawingManager.setDrawingMode(google.maps.drawing.OverlayType.POLYGON); } else{try{GoogleMap.DrawingManager.setDrawingMode(null);} catch(err){} } }" +
                "function PolygonExists(id) {if(GoogleMap.Map != null) return (!(GoogleMap.Polygons['M' + id] == null || GoogleMap.Polygons['M' + id] == undefined)); return false; }" +
                "function PolygonVisible(id) {if(GoogleMap.Map != null) if(PolygonExists(id)) return (!(GoogleMap.Polygons['M' + id].map == null)); return false; }" +
                "function HidePolygon(id) {if(GoogleMap.Map != null) if(PolygonExists(id)) GoogleMap.Polygons['M' + id].setMap(null); }" +
                "function ShowPolygon(id) {if(GoogleMap.Map != null) if(PolygonExists(id)) GoogleMap.Polygons['M' + id].setMap(GoogleMap.Map); }" +
                "function GetPolygonPath(id) {if(GoogleMap.Map != null) if(PolygonExists(id)) return GetPathFromArray(GoogleMap.Polygons['M' + id].getPath()); return null; }" +
                "function SetPolygonPath(id, path) {if(GoogleMap.Map != null) if(PolygonExists(id)) GoogleMap.Polygons['M' + id].setPath(path); }" +
                "function GetPolygonColor(id) {if(GoogleMap.Map != null) if(PolygonExists(id)) return GoogleMap.Polygons['M' + id].fillColor; return null; }" +
                "function SetPolygonColor(id, color) {if(GoogleMap.Map != null) if(PolygonExists(id)) GoogleMap.Polygons['M' + id].setOptions({fillColor: color, strokeColor: color }); }" +
                "function GetPolygonOpacity(id) {if(GoogleMap.Map != null) if(PolygonExists(id)) return GoogleMap.Polygons['M' + id].fillOpacity; return null; }" +
                "function SetPolygonOpacity(id, opacity) {if(GoogleMap.Map != null) if(PolygonExists(id)) GoogleMap.Polygons['M' + id].setOptions({fillOpacity: opacity }); }" +
                "function GetPolygonClickable(id) {if(GoogleMap.Map != null) if(PolygonExists(id)) return GoogleMap.Polygons['M' + id].clickable; return false; }" +
                "function SetPolygonClickable(id, clickable) {if(GoogleMap.Map != null) if(PolygonExists(id)) GoogleMap.Polygons['M' + id].setOptions({clickable: clickable }); }" +
                "function GetPolygonEditable(id) {if(GoogleMap.Map != null) if(PolygonExists(id)) return GoogleMap.Polygons['M' + id].getEditable(); return false; }" +
                "function SetPolygonEditable(id, editable) {if(GoogleMap.Map != null) if(PolygonExists(id)) GoogleMap.Polygons['M' + id].setOptions({editable: editable }); }" +
                "function DeleteAllPolygons() {GetListID(GoogleMap.Polygons).forEach(function (id) {DeletePolygon(id); }); }" +
                "function DeletePolygon(id) {if(GoogleMap.Map != null) if(PolygonExists(id)){HidePolygon(id); delete  GoogleMap.Polygons['M' + id]; } }" +
                "function PolygonContainsLocation(id, position) {if(GoogleMap.Map != null) if(PolygonExists(id)) return google.maps.geometry.poly.containsLocation(new google.maps.LatLng(position), GoogleMap.Polygons['M' + id]); return false; }" +
                "function GetHousesInPolygon(id) {var IDs = []; if(GoogleMap.Map != null) if(PolygonExists(id)){ConvertObjectToArray(GoogleMap.Houses).forEach(function (house) {if(PolygonContainsLocation(id, ConvertLatLngToObject(house.getPosition()))) IDs.push(house.id); }); return IDs; } return []; }" +
                "function CreatePolygon(id, path, color, opacity, clickable) {if(GoogleMap.Map != null){if(PolygonExists(id)) GoogleMap.Polygons['M' + id].setMap(null); GoogleMap.Polygons['M' + id] = new google.maps.Polygon({clickable: clickable, editable: false, paths: path, strokeColor: color, strokeOpacity: 0.7, strokeWeight: 2, fillColor: color, fillOpacity: opacity, map: GoogleMap.Map, id: id }); GoogleMap.Polygons['M' + id].addListener('click', function(event) {  window.external._MapPolygonClick(this.id); }); GoogleMap.Polygons['M' + id].addListener('rightclick', function(event) { window.external._MapPolygonRightClick(this.id); }); } }" +
                "function initAutocomplete() {" +
                    "GoogleMap.Map = new google.maps.Map(document.getElementById('map'), {center: {lat: 12.8797, lng: 121.7740}, zoom: 6, mapTypeId: 'roadmap', backgroundColor: 'black'});" +
                    "GoogleMap.DrawingManager = new google.maps.drawing.DrawingManager({drawingControl: false, map: GoogleMap.Map, drawingControlOptions: {position: google.maps.ControlPosition.TOP_CENTER, drawingModes: [google.maps.drawing.OverlayType.POLYGON ] }, polygonOptions: {editable: true, strokeColor: 'red', strokeOpacity: 0.7, fillColor: 'red', fillOpacity: 0.2, strokeWeight: 2 } });" +
                    "GoogleMap.DrawingManager.addListener('polygoncomplete', function(polygon) { if(GoogleMap.DrawingMode){ window.external._MapDrawingComplete(JSON.stringify(GetPathFromArray(polygon.getPath()))); } polygon.setMap(null); });" +
                    "GoogleMap.Map.addListener('click', function(event) { window.external._MapClick(event.latLng.lat(), event.latLng.lng()); });" +
                    "GoogleMap.Map.addListener('rightclick', function(event) { window.external._MapRightClick(event.latLng.lat(), event.latLng.lng()); });" +
                    "LoadPage.Hide();" +
                "}" +
                "LoadPage.Show();" +
                "document.body.onkeydown = function (e) {if(e.keyCode == 116) e.preventDefault(); }" +
            "</script>";
        #endregion
        //Initialization
        #region

        private string HTMLDocument = "";
        private string GoogleMapURL = "";
        private string GoogleMapUrlAPIkey = "";
        private string ValidSecretPassword = "a3U%-#jVr!unRy#yX%8Rt:,G'r:DK-H,WJ~6fE!kr9yG5~5.HnRgPpNdh;9pp^_-L9QeEqyk_w_";
        private string InputSecretPassword = "";
        [Description("Javascript Library Url"), Category("Google Maps")]
        public string GoogleMapLibraryKey
        {
            get { return GoogleMapUrlAPIkey; }
            set
            {
                GoogleMapUrlAPIkey = value;
                ReloadMap();
            }
        }
        [Description("NJB Security"), Category("Google Maps")]
        public string SecretPassword
        {
            get { return InputSecretPassword; }
            set {
                InputSecretPassword = value;
                ReloadMap();
            }
        }
        public NJBGoogleMap()
        {
            InitializeComponent();
            WebBrowser.ObjectForScripting = this;
            WebBrowser.IsWebBrowserContextMenuEnabled = false;
        }
        #endregion

        //Event
        private void WebBrowser_DocumentCompleted(object sender, WebBrowserDocumentCompletedEventArgs e)
        {
            
            //if (MapIsReady())
            //{
            //    HideLoading();
            //    OnMapLoadSuccess(new EventArgs());
            //}
            //else
            //{
            //    ShowLoading("<h2>Connection Error</h2>Please check your internet connection");
            //    Action CheckGoogleMapLibrary = () =>
            //    {
            //        bool x = false;
            //        while (!x)

            //        {
            //            System.Threading.Thread.Sleep(1000);
            //            x = RemoteFileExists(GoogleMapURL);
            //        }
            //        ReloadMap();
            //    };
            //    System.Threading.Tasks.Task.Factory.StartNew(CheckGoogleMapLibrary);
            //    OnMapLoadError(new EventArgs());
            //}
        }

        private void NJBGoogleMap_Paint(object sender, PaintEventArgs e)
        {
            Action LoadMap = () =>
            {
                System.Threading.Thread.Sleep(500);
                ReloadMap();
            };
            System.Threading.Tasks.Task.Factory.StartNew(LoadMap);
        }

        //General
        private string GetJSON(object obj)
        {
            return new JavaScriptSerializer().Serialize(obj);
        }
        #region
        private string GetImageBase64Url(Image image)
        {
            string type = "";
            MemoryStream stream = new MemoryStream();
            image.Save(stream, image.RawFormat);
            byte[] image_bytes = stream.ToArray();
            string base64 = Convert.ToBase64String(image_bytes);
            if (ImageFormat.Jpeg.Equals(image.RawFormat)) type = "jpeg";
            else if (ImageFormat.Png.Equals(image.RawFormat)) type = "png";
            return "data:image/" + type + ";base64," + base64;
        }
        private object GetObject(string code)
        {
            return WebBrowser.Document.InvokeScript("eval", new object[] { code });
        }
        private string GetStringVal(string code)
        {
            try
            {
                if (code != null)
                    if (GetObject(code).ToString() != null)
                        return GetObject(code).ToString();
                return "";
            }
            catch(Exception e) {
                return "";
            }
        }
        private bool GetBoolVal(string code)
        {
            if (GetStringVal(code).ToUpper() == "TRUE")
                return true;
            return false;
        }
        private void EvaluateScript(string script)
        {
            WebBrowser.Document.InvokeScript("eval", new object[] { script });
        }
        private bool RemoteFileExists(string url)
        {
            try
            {
                HttpWebRequest request = WebRequest.Create(url) as HttpWebRequest;
                request.Method = "HEAD";
                HttpWebResponse response = request.GetResponse() as HttpWebResponse;
                response.Close();
                return (response.StatusCode == HttpStatusCode.OK);
            }
            catch
            {
                return false;
            }
        }
        private string EscapeString(string text)
        {
            return text.Replace("\'", "\\'");
        }
        private bool IsValidAsID(string text)
        {
            Regex ident = new Regex("^[A-Za-z0-9_]+$");
            return ident.IsMatch(text);
        }
        private void ValidateID(string text)
        {
            if (IsValidAsID(text))
                return;
            throw new MapInvalidIDException("Invalid ID. Spaces and special characters are not allowed.");
        }
        private string GetBoolString(bool arg)
        {
            if (arg)
                return "true";
            return "false";
        }
        #endregion
        //Load
        #region
        public void ReloadMap()
        {
            if (InputSecretPassword != ValidSecretPassword) WebBrowser.DocumentText = "<h4>Invalid Secret Password.</h4>";
            else if (GoogleMapUrlAPIkey == "") WebBrowser.DocumentText = "<h4>Google Maps API Key is required.</h4>";
            else
            {
                try
                {
                    string APIkey = "key=" + GoogleMapUrlAPIkey + "&";
                    GoogleMapURL = "https://maps.googleapis.com/maps/api/js?" + APIkey + "libraries=places,drawing&callback=initAutocomplete";
                    HTMLDocument = "" +
                        "<!DOCTYPE html>" +
                        "<html lang=\"en\">" +
                            "<head>" +
                                "<meta charset=\"UTF-8\" />" +
                                "<meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">" +
                                "<title>Google Map</title>" +
                                Style +
                            "</head>" +
                            "<body>" +
                                Body +
                                Script +
                                "<script src=\"" + GoogleMapURL + "\" onload=\"MapLoadSuccess()\" onerror=\"MapLoadError()\" async defer></script>" +
                            "</body>" +
                        "</html>";
                    WebBrowser.DocumentText = HTMLDocument;
                }
                catch (Exception e) { }
            }
        }
        public void ShowLoading(string Title)
        {
            EvaluateScript("LoadPage.ChangeTitle('" + EscapeString(Title) + "');");
            EvaluateScript("LoadPage.Show();");
        }
        public void HideLoading()
        {
            EvaluateScript("LoadPage.Hide();");
        }
        #endregion
        //Map
        #region
        public bool MapIsReady()
        {
            return GetBoolVal("MapIsReady();");
        }
        public MapLatLng GetMapCenter()
        {
            double lat = Convert.ToDouble(GetObject("GetMapCenter().lat;"));
            double lng = Convert.ToDouble(GetObject("GetMapCenter().lng;"));
            return new MapLatLng(lat, lng);
        }
        public void SetMapCenter(MapLatLng LatLng)
        {
            EvaluateScript("SetMapCenter(" + LatLng.ToString() + ");");
        }
        public string GetMapType()
        {
            return GetStringVal("GetMapType();");
        }
        public void SetMapType(string MapType){
            EvaluateScript("SetMapType('" + MapType + "');");
        }
        public int GetMapZoom()
        {
            return Convert.ToInt32(GetStringVal("GetMapZoom();"));
        }
        public void SetMapZoom(int Zoom){
            EvaluateScript("SetMapZoom(" + Zoom + ");");
        }
        #endregion
        //Marker
        #region
        public bool MarkerExists(string ID){
            ValidateID(ID);
            return GetBoolVal("MarkerExists('" + ID + "');");
        }
        public bool MarkerVisible(string ID)
        {
            ValidateID(ID);
            return GetBoolVal("MarkerVisible('" + ID + "');");
        }
        public void HideMarker(string ID)
        {
            ValidateID(ID);
            EvaluateScript("HideMarker('" + ID + "');");
        }
        public void ShowMarker(string ID)
        {
            ValidateID(ID);
            EvaluateScript("ShowMarker('" + ID + "');");
        }
        public MapLatLng GetMarkerPosition(string ID)
        {
            ValidateID(ID);
            double lat = Convert.ToDouble(GetObject("GetMarkerPosition('" + ID + "').lat;"));
            double lng = Convert.ToDouble(GetObject("GetMarkerPosition('" + ID + "').lng;"));
            return new MapLatLng(lat, lng);
        }
        public void SetMarkerPosition(string ID, MapLatLng LatLng)
        {
            ValidateID(ID);
            EvaluateScript("SetMarkerPosition('" + ID + "', " + LatLng.ToString() + ");");
        }
        public string GetMarkerTitle(string ID)
        {
            ValidateID(ID);
            return GetStringVal("GetMarkerTitle('" + ID + "');");
        }
        public void SetMarkerTitle(string ID, string Title)
        {
            ValidateID(ID);
            EvaluateScript("SetMarkerTitle('" + ID + "', '" + EscapeString(Title) + "');");
        }
        public void DeleteMarker(string ID)
        {
            ValidateID(ID);
            EvaluateScript("DeleteMarker('" + ID + "');");
        }
        public void DeleteAllMarkers()
        {
            EvaluateScript("DeleteAllMarkers();");
        }
        public bool GetMarkerDraggable(string ID)
        {
            ValidateID(ID);
            return GetBoolVal("GetMarkerDraggable('" + ID + "');");
        }
        public void SetMarkerDraggable(string ID, bool Draggable)
        {
            ValidateID(ID);
            EvaluateScript("SetMarkerDraggable('" + ID + "', " + GetBoolString(Draggable) + ");");
        }
        public string[] GetMarkerIDList()
        {
            string json = GetStringVal("JSON.stringify(GetListID(GoogleMap.Markers));");
            json = json.Replace("[", "");
            json = json.Replace("]", "");
            json = json.Replace("\"", "");
            if (json == "" || json.Trim() == "")
                return new string[0];
            return json.Split(',');
        }
        public void CreateMarker(string ID, string Title, MapLatLng LatLng, bool Draggable)
        {
            ValidateID(ID);
            string eTitle = EscapeString(Title);
            EvaluateScript("CreateMarker('" + ID + "', '" + eTitle + "', " + LatLng.ToString() + ", " + GetBoolString(Draggable) + ");");
        }
        public string GetMarkerIcon(string ID)
        {
            ValidateID(ID);
            return GetStringVal("GetMarkerIcon('" + ID + "');");
        }
        public void SetMarkerIcon(string ID, string icon)
        {
            // icon = original
            // value = converted for rendering
            string value = icon;
            ValidateID(ID);
            if (icon != "" && File.Exists(icon)) value = GetImageBase64Url(Image.FromFile(icon));
            EvaluateScript("SetMarkerIcon("+GetJSON(ID)+", "+GetJSON(icon)+", "+GetJSON(value)+");");
        }


        #endregion
        //Houses
        #region
        public void FitHousesToMap()
        {
            EvaluateScript("FitHousesToMap()");
        }
        public bool HouseExists(string ID)
        {
            ValidateID(ID);
            return GetBoolVal("HouseExists('" + ID + "');");
        }
        public bool HouseVisible(string ID)
        {
            ValidateID(ID);
            return GetBoolVal("HouseVisible('" + ID + "');");
        }
        public void HideHouse(string ID)
        {
            ValidateID(ID);
            EvaluateScript("HideHouse('" + ID + "');");
        }
        public void ShowHouse(string ID)
        {
            ValidateID(ID);
            EvaluateScript("ShowHouse('" + ID + "');");
        }
        public MapLatLng GetHousePosition(string ID)
        {
            ValidateID(ID);
            double lat = Convert.ToDouble(GetObject("GetHousePosition('" + ID + "').lat;"));
            double lng = Convert.ToDouble(GetObject("GetHousePosition('" + ID + "').lng;"));
            return new MapLatLng(lat, lng);
        }
        public void SetHousePosition(string ID, MapLatLng LatLng)
        {
            ValidateID(ID);
            EvaluateScript("SetHousePosition('" + ID + "', " + LatLng.ToString() + ");");
        }
        public string GetHouseTitle(string ID)
        {
            ValidateID(ID);
            return GetStringVal("GetHouseTitle('" + ID + "');");
        }
        public void SetHouseTitle(string ID, string Title)
        {
            ValidateID(ID);
            EvaluateScript("SetHouseTitle('" + ID + "', '" + EscapeString(Title) + "');");
        }
        public char GetHouseLabel(string ID)
        {
            ValidateID(ID);
            return Convert.ToChar(GetStringVal("GetHouseLabel('" + ID + "');"));
        }
        public void SetHouseLabel(string ID, char Label)
        {
            ValidateID(ID);
            EvaluateScript("SetHouseLabel('" + ID + "', '" + EscapeString(Label.ToString()) + "');");
        }
        public MapHouseColor GetHouseColor(string ID)
        {
            ValidateID(ID);
            string primary = GetStringVal("GetHouseColor('" + ID + "').primary;");
            string secondary = GetStringVal("GetHouseColor('" + ID + "').secondary;");
            return new MapHouseColor(primary, secondary);
        }
        public void SetHouseColor(string ID, MapHouseColor Color)
        {
            ValidateID(ID);
            EvaluateScript("SetHouseColor('" + ID + "', " + Color.ToString() + ");");
        }
        public void DeleteHouse(string ID)
        {
            ValidateID(ID);
            EvaluateScript("DeleteHouse('" + ID + "');");
        }
        public void DeleteAllHouses()
        {
            EvaluateScript("DeleteAllHouses();");
        }
        public bool GetHouseDraggable(string ID)
        {
            ValidateID(ID);
            return GetBoolVal("GetHouseDraggable('" + ID + "');");
        }
        public void SetHouseDraggable(string ID, bool Draggable)
        {
            ValidateID(ID);
            EvaluateScript("SetHouseDraggable('" + ID + "', " + GetBoolString(Draggable) + ");");
        }
        public void SelectHouse(string ID)
        {
            ValidateID(ID);
            EvaluateScript("SelectHouse('" + ID + "');");
        }
        public void DeselectHouse(string ID)
        {
            ValidateID(ID);
            EvaluateScript("DeselectHouse('" + ID + "');");
        }
        public bool HouseSelected(string ID)
        {
            ValidateID(ID);
            return GetBoolVal("HouseSelected('" + ID + "');");
        }
        public bool GetSelectMode()
        {
            return GetBoolVal("GoogleMap.SelectMode;");
        }
        public void SetSelectMode(bool Mode)
        {
            EvaluateScript("SelectMode(" + GetBoolString(Mode) + ");");
        }
        public string[] GetHouseIDList()
        {
            string json = GetStringVal("JSON.stringify(GetListID(GoogleMap.Houses));");
            json = json.Replace("[", "");
            json = json.Replace("]", "");
            json = json.Replace("\"", "");
            if (json == "" || json.Trim() == "")
                return new string[0];
            return json.Split(',');
        }
        public string[] GetSelectedHouseIDList()
        {
            string json = GetStringVal("JSON.stringify(GetListID(GoogleMap.SelectedHouses));");
            json = json.Replace("[", "");
            json = json.Replace("]", "");
            json = json.Replace("\"", "");
            if (json == "" || json.Trim() == "")
                return new string[0];
            return json.Split(',');
        }
        public void CreateHouse(string ID, string Title, MapLatLng LatLng, Char Label, MapHouseColor Color, bool Draggable)
        {
            ValidateID(ID);
            EvaluateScript("CreateHouse('" + ID + "', '" + EscapeString(Title) + "', " + LatLng.ToString() + ", '" + EscapeString(Label.ToString()) + "', " + Color.ToString() + ", " + GetBoolString(Draggable) + ");");
        }
        #endregion
        //Polygon
        #region
        public bool GetDrawingMode()
        {
            return GetBoolVal("GoogleMap.DrawingMode;");
        }
        public void SetDrawingMode(bool Mode)
        {
            EvaluateScript("DrawingMode(" + GetBoolString(Mode) + ");");
        }
        public bool PolygonExists(string ID)
        {
            ValidateID(ID);
            return GetBoolVal("PolygonExists('" + ID + "');");
        }
        public bool PolygonVisible(string ID)
        {
            ValidateID(ID);
            return GetBoolVal("PolygonVisible('" + ID + "');");
        }
        public void HidePolygon(string ID)
        {
            ValidateID(ID);
            EvaluateScript("HidePolygon('" + ID + "');");
        }
        public void ShowPolygon(string ID)
        {
            ValidateID(ID);
            EvaluateScript("ShowPolygon('" + ID + "');");
        }
        public MapLatLng[] GetPolygonPath(string ID)
        {
            ValidateID(ID);
            string json = GetStringVal("JSON.stringify(GetPolygonPath('" + ID + "'));");
            
            List<MapLatLng> LatLng = new List<MapLatLng>();
            json = json.Replace("[", "");
            json = json.Replace("]", "");
            json = json.Replace("\"", "");
            json = json.Replace("},", "}*");
            foreach (string str in json.Split('*'))
            {
                string val = str;
                val = val.Replace("{lat:", "");
                val = val.Replace("lng:", "");
                val = val.Replace("}", "");
                LatLng.Add(new MapLatLng(Convert.ToDouble(val.Split(',')[0]), Convert.ToDouble(val.Split(',')[1])));
            }
            return LatLng.ToArray();
        }
        public void SetPolygonPath(string ID, MapLatLng[] Path)
        {
            ValidateID(ID);
            string stringvar = "[";
            for (int i = 0; i < Path.Length; i++)
                stringvar += Path[i].ToString() + ", ";
            stringvar = stringvar.Substring(0, stringvar.Length - 2);
            stringvar += "]";
            EvaluateScript("SetPolygonPath('" + ID + "', " + stringvar + ");");
        }
        public string GetPolygonColor(string ID)
        {
            ValidateID(ID);
            return GetStringVal("GetPolygonColor('" + ID + "');");
        }
        public void SetPolygonColor(string ID, string Color)
        {
            ValidateID(ID);
            EvaluateScript("SetPolygonColor('" + ID + "', '" + EscapeString(Color) + "');");
        }
        public double GetPolygonOpacity(string ID)
        {
            ValidateID(ID);
            return Convert.ToDouble(GetStringVal("GetPolygonOpacity('" + ID + "');"));
        }
        public void SetPolygonOpacity(string ID, double Opacity)
        {
            ValidateID(ID);
            EvaluateScript("SetPolygonOpacity('" + ID + "', " + Opacity + ");");
        }
        public bool GetPolygonClickable(string ID)
        {
            ValidateID(ID);
            return GetBoolVal("GetPolygonClickable('" + ID + "');");
        }
        public void SetPolygonClickable(string ID, bool Clickable)
        {
            ValidateID(ID);
            EvaluateScript("SetPolygonClickable('" + ID + "', " + GetBoolString(Clickable) + ");");
        }
        public bool GetPolygonEditable(string ID)
        {
            ValidateID(ID);
            return GetBoolVal("GetPolygonEditable('" + ID + "');");
        }
        public void SetPolygonEditable(string ID, bool Editable)
        {
            ValidateID(ID);
            EvaluateScript("SetPolygonEditable('" + ID + "', " + GetBoolString(Editable) + ");");
        }
        public void DeletePolygon(string ID)
        {
            ValidateID(ID);
            EvaluateScript("DeletePolygon('" + ID + "');");
        }
        public void DeleteAllPolygons()
        {
            EvaluateScript("DeleteAllPolygons();");
        }
        public bool PolygonContainsLocation(string ID, MapLatLng LatLng)
        {
            ValidateID(ID);
            return GetBoolVal("PolygonContainsLocation('" + ID + "', " + LatLng.ToString() + ");");
        }
        public string[] GetHousesInPolygon(string ID)
        {
            ValidateID(ID);
            string json = GetStringVal("JSON.stringify(GetHousesInPolygon('" + ID + "'));");
            json = json.Replace("[", "");
            json = json.Replace("]", "");
            json = json.Replace("\"", "");
            if (json == "" || json.Trim() == "")
                return new string[0];
            return json.Split(',');
        }
        public string[] GetPolygonIDList()
        {
            string json = GetStringVal("JSON.stringify(GetListID(GoogleMap.Polygons));");
            json = json.Replace("[", "");
            json = json.Replace("]", "");
            json = json.Replace("\"", "");
            if (json == "" || json.Trim() == "")
                return new string[0];
            return json.Split(',');
        }
        public void CreatePolygon(string ID, MapLatLng[] Path, string Color, double Opacity, bool Clickable)
        {
            ValidateID(ID);
            string stringvar = "[";
            for (int i = 0; i < Path.Length; i++)
                stringvar += Path[i].ToString() + ", ";
            stringvar = stringvar.Substring(0, stringvar.Length - 2);
            stringvar += "]";
            EvaluateScript("CreatePolygon('" + ID + "', " + stringvar + ", '" + Color + "', " + Opacity + ", " + GetBoolString(Clickable) + ");");
        }
        #endregion
    }

    public class MapLatLng
    {
        public double lat;
        public double lng;
        public MapLatLng(double lat, double lng)
        {
            this.lat = lat;
            this.lng = lng;
        }
        public override string ToString()
        {
            return "{lat: " + lat + ", lng: " + lng + "}";
        }
    }
    public class MapHouseColor
    {
        public string primary;
        public string secondary;
        public MapHouseColor(string primary, string secondary)
        {
            this.primary = primary;
            this.secondary = secondary;
        }
        private string EscapeString(string text)
        {
            return text.Replace("\'", "\\'");
        }
        public override string ToString()
        {
            return "{primary: '" + EscapeString(primary) + "', secondary: '" + EscapeString(secondary) + "'}";
        }
    }
    public static class MapType
    {
        public static readonly string Roadmap = "roadmap";
        public static readonly string Satellite = "satellite";
        public static readonly string Hybrid = "hybrid";
        public static readonly string Terrain = "terrain";
    }
    public static class MapExtraTools
    {
        public static string PickColor()
        {
            string color = "";
            ColorDialog c = new ColorDialog();
            if (c.ShowDialog() == DialogResult.OK)
            {
                color = string.Format("{0:X6}", c.Color.ToArgb());
                color = color.Substring(2, color.Length - 2);
                color = "#" + color;
            }
            else
            {
                return null;
            }
            return color;
        }
    }
    public class MapInvalidIDException : Exception
    {
        public MapInvalidIDException()
        {

        }

        public MapInvalidIDException(string message)
            : base(message)
        {

        }

        public MapInvalidIDException(string message, Exception inner)
            : base(message, inner)
        {

        }
    }
    public class MapClickEventArgs : EventArgs
    {
        public readonly MapLatLng LatLng;

        public MapClickEventArgs(MapLatLng LatLng)
        {
            this.LatLng = LatLng;
        }
    }
    public class MapItemClickEventArgs : EventArgs
    {
        public readonly string ID;

        public MapItemClickEventArgs(string ID)
        {
            this.ID = ID;
        }
    }
    public class MapDrawingCompleteEventArgs : EventArgs
    {
        public readonly MapLatLng[] Path;
        public MapDrawingCompleteEventArgs(MapLatLng[] Path)
        {
            this.Path = Path;
        }
    }
}
